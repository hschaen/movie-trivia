<!DOCTYPE html>
<html>
    <head>
        <title>Movie Trivia</title>
    </head>
    <body>
        <div id="movie-buttons"></div>
        <form>
            <label for="add-movies">Add a Movie</label>
            <input type="text" id="add-movies" />
            <input type="submit" id="submit-movie" value="Add a Movie">
        </form>
        <div id="questions"></div>
        <div id="answersInput"></div>
        <div id="answer"></div>
        <div id="score"></div>
        <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
        <script type="text/javascript">
            var count = 0;
            //Start with some movies
            var movies = ["The Matrix", "The Big Lebowski", "Finding Nemo", "Pulp Fiction"];
            //Render movie buttons
            var addButtons = function() {
                $("#movie-buttons").empty();
                for (var i = 0; i < movies.length; i++) {
                    var newButton = $("<button>");
                    newButton.text(movies[i]);
                    newButton.attr("data-name", movies[i]);
                    newButton.addClass("movie");
                    $("#movie-buttons").append(newButton);
                }
            }
            // Ask a question
            var questions = [
                "Who directed this movie?",
                "Who was the lead actor?",
                "What year did this film come out?",
                "What was this movie rated?"
            ];
            //Add a movie
            $("#submit-movie").on("click", function(e) {
                e.preventDefault();
                var newMovie = $("#add-movies").val().trim();
                movies.push(newMovie);
                addButtons();
            });
            // Choose Your Movie
            $(document).on("click",".movie", function() {
                var random = Math.floor(Math.random() * movies.length);
                var selectedQuestion = questions[random];
                $("#questions").text(selectedQuestion);
                $("#answersInput").html("<form><input type='text' id='yourAnswer' /><input type='submit' id='submitAnswer'></form>");
                var movie = $(this).attr("data-name");
                console.log(movie);
                
                //Find Movie Info
                var queryURL = "https://www.omdbapi.com/?t=" + movie + "&apikey=trilogy";
                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).then(function(response) {
                    console.log(response);

                    // Check if this is a movie or not
                    if(response.Response == "False") {
                        alert("This is not a movie");
                        console.log();
                    }
                    // Store Movie Info
                    var director = response.Director;
                    var actor = response.Actors;
                    var year = response.Year;
                    var rating = response.Rated;

                    // Start the Game
                    $(document).on("click","#submitAnswer", function(e) {
                        e.preventDefault();
                        var yourAnswer = $("#yourAnswer").val();
                        if (random == 0) {
                            if(yourAnswer == director) {
                                $("#answer").text("You're Right!");
                                count++;
                            } else {
                                $("#answer").text("You're Wrong.");
                            }
                        }
                        if (random == 1) {
                            if(yourAnswer == actor) {
                                $("#answer").text("You're Right!");
                                count++;
                            } else {
                                $("#answer").text("You're Wrong.");
                            }
                        }
                        if (random == 2) {
                            if(yourAnswer == year) {
                                $("#answer").text("You're Right!");
                                count++;                                
                            } else {
                                $("#answer").text("You're Wrong.");
                            }
                        }
                        if (random == 3) {
                            if(yourAnswer == rating) {
                                count++;
                                $("#answer").text("You're Right!");
                            } else {
                                $("#answer").text("You're Wrong.");
                            }
                        }
                        $("#score").text(count);

                    });
                });
                
            });
            
            addButtons();
        </script>
    </body>
</html>